// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace StartupEd.UX.Incubation.Pages.BPage
{
    #line hidden
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 13 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using System;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using System.Text.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.Lib.Engine;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.Extensions.DependencyInjection;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.Lib.Engine.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.Lib.Core;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 26 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 31 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 32 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 33 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Shared.Layouts;

#line default
#line hidden
#nullable disable
#nullable restore
#line 34 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Shared.Pages;

#line default
#line hidden
#nullable disable
#nullable restore
#line 36 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Grouping;

#line default
#line hidden
#nullable disable
#nullable restore
#line 38 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Connections;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.BPage;

#line default
#line hidden
#nullable disable
#nullable restore
#line 40 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Others;

#line default
#line hidden
#nullable disable
#nullable restore
#line 41 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.InProgress;

#line default
#line hidden
#nullable disable
#nullable restore
#line 42 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Settings;

#line default
#line hidden
#nullable disable
#nullable restore
#line 43 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Invite;

#line default
#line hidden
#nullable disable
#nullable restore
#line 44 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.FeedPage;

#line default
#line hidden
#nullable disable
#nullable restore
#line 45 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Chatting;

#line default
#line hidden
#nullable disable
#nullable restore
#line 46 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Sidebar;

#line default
#line hidden
#nullable disable
#nullable restore
#line 47 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Milestone;

#line default
#line hidden
#nullable disable
#nullable restore
#line 48 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.Authentication;

#line default
#line hidden
#nullable disable
#nullable restore
#line 49 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.Pages.ProfileTemplates;

#line default
#line hidden
#nullable disable
#nullable restore
#line 51 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One;

#line default
#line hidden
#nullable disable
#nullable restore
#line 52 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 54 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 55 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 56 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Charts;

#line default
#line hidden
#nullable disable
#nullable restore
#line 57 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Maps;

#line default
#line hidden
#nullable disable
#nullable restore
#line 58 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Post;

#line default
#line hidden
#nullable disable
#nullable restore
#line 59 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Views.Card;

#line default
#line hidden
#nullable disable
#nullable restore
#line 60 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Views.Flix;

#line default
#line hidden
#nullable disable
#nullable restore
#line 61 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Views.Grid;

#line default
#line hidden
#nullable disable
#nullable restore
#line 62 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Views.List;

#line default
#line hidden
#nullable disable
#nullable restore
#line 63 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Toast;

#line default
#line hidden
#nullable disable
#nullable restore
#line 64 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Composer;

#line default
#line hidden
#nullable disable
#nullable restore
#line 65 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Reactions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 66 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 67 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Shared.PdfViewer;

#line default
#line hidden
#nullable disable
#nullable restore
#line 69 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout;

#line default
#line hidden
#nullable disable
#nullable restore
#line 70 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout.Base;

#line default
#line hidden
#nullable disable
#nullable restore
#line 71 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout.Aside;

#line default
#line hidden
#nullable disable
#nullable restore
#line 72 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout.Footer;

#line default
#line hidden
#nullable disable
#nullable restore
#line 73 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout.Header;

#line default
#line hidden
#nullable disable
#nullable restore
#line 74 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.One.Components.Layout.Header.TopBar;

#line default
#line hidden
#nullable disable
#nullable restore
#line 78 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.SuperAdmin.Components.Feeds;

#line default
#line hidden
#nullable disable
#nullable restore
#line 79 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
using StartupEd.UX.Incubation.SuperAdmin.Components.Cards;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/Pages/BPage/_Imports.razor"
using StartupEd.UX.One.Components.Custom.BrowserFlix;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/Pages/BPage/_Imports.razor"
using StartupEd.UX.One.Shared_Classes;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/Pages/BPage/_Imports.razor"
using StartupEd.UX.Incubation.Pages.JobPosting;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/Pages/BPage/BPageOLP.razor"
using Microsoft.AspNetCore.SignalR.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/_Imports.razor"
[Authorize]

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/businesspage/{Id}/{PageName}")]
    public partial class BPageOLP : BaseComponent
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 436 "/Users/ankitbuti/workspace/bigapple_corev3/UXs/Incubation/Pages/BPage/BPageOLP.razor"
      
    [Parameter]
    public string Id { get; set; }
    [Parameter]
    public string PageName { get; set; }
    public string BusinessPageRoute { get; set; }
    public BusinessPage Page { get; set; } = new BusinessPage();
    public List<JobPosting> Jobs = new List<JobPosting>();
    public BusinessPage_ClientService ClientService { get; set; }
    public JobPosting_ClientService Service { get; set; }
    public bool ShowAlertBox { get; set; } = false;
    public string ProgramView { get; set; } = "Flix";
    private string SearchString { get; set; }
    public string JobId { get; set; }
    public bool IsApplied { get; set; } = false;
    private OneUX_SweetAlertBox ConfirmSweetAlertForBPage { get; set; }
    private OneUX_SweetAlertBox ConfirmSweetAlertForJobPosting { get; set; }
    public enum LoadingContainerState { Loading, Loaded, Error }
    public LoadingContainerState State;
    private Notification_ClientService NotificationClientService { get; set; }
    private UserActivity_ClientService Activity_ClientService { get; set; }
    private HubConnection notificationBPOLikeHubConnection;

    public void DisableApplybtn()
    {

        StateHasChanged();
    }

    public void ToggleView(string view)
    {

        ProgramView = view;
        StateHasChanged();
    }


    public void ShowSweetAlert1()
    {
        ConfirmSweetAlertForBPage.ShowSweetAlert();
    }

    public void ShowSweetAlert2(string Id)
    {
        if (Id != null)
        {
            JobId = Id;
        }
        ConfirmSweetAlertForJobPosting.ShowSweetAlert();
    }



    protected override async Task OnInitializedAsync()
    {
        try
        {
            PageName = PageName.Replace(" ", "-");
            await SyncLoggedInUserStatus();
            State = LoadingContainerState.Loading;
            ClientService = new BusinessPage_ClientService(EngineServices.MarketNetwork);
            Activity_ClientService = new UserActivity_ClientService(EngineServices.MarketNetwork);
            Service = new JobPosting_ClientService(EngineServices.MarketNetwork);
            NotificationClientService = new Notification_ClientService(EngineServices.MarketNetwork);
            notificationBPOLikeHubConnection = new HubConnectionBuilder().WithUrl(EngineServices.MarketNetwork.EndPoint + "/notificationhub").Build();
            await notificationBPOLikeHubConnection.StartAsync();
        }
        catch (NullReferenceException e)
        {
            SLog.Write(e.Message);
        }
    }
    public bool IsNotiBPOLikeConnected => notificationBPOLikeHubConnection.State == HubConnectionState.Connected;
    Task SendBPageOLikeNotification() => notificationBPOLikeHubConnection.SendAsync("SendNotification", UXUtility.LoggedInUser.Id, "Business Page Notification");

    protected async override Task OnParametersSetAsync()
    {
        try
        {
            if (Id != null)
            {
                Page = await ClientService.GetBusinessPageById(Id);
                BusinessPageRoute = $"/{Page.Id}/{Page.Name}/job/create";
                Jobs = await Service.GetJobPostingsByBusinessPageId(Id);
                Jobs = Jobs.OrderByDescending(x => x.Core.CreatedAt).ToList();
                State = LoadingContainerState.Loaded;
                StateHasChanged();
            }
        }
        catch (Exception e)
        {
            SLog.Write(e.Message);
            State = LoadingContainerState.Error;
        }
    }

    public async void DeleteBPage(bool IsValue)
    {
        try
        {
            if (IsValue)
            {
                HttpResponseMessage message = await ClientService.DeleteAsync(Page.Id);
                if (message.IsSuccessStatusCode)
                {
                    await BusinessPageRecentActivity(Page.Id, Page.Name, "You have recently deleted Business Page" + Page.Name);

                    ToastService.ShowSuccess("Page Deleted Successfuly");
                    navigationManager.NavigateTo("/businesspage");
                }
            }
        }
        catch (Exception ex)
        {
            ToastService.ShowError(ex.Message, "Page Exception");
        }
    }

    public Dictionary<string, string> Tabs = new Dictionary<string, string>() {
        {"About","fas fa-user"},
        {"Jobs","fas fa-lightbulb"},
        //{"Events","fas fa-calendar-alt"},
       // {"Incubation Programs","fas fa-user-graduate"}
        //{"Entrepreneurial Education","fas fa-book"},
    };


    public async Task PageLikes()
    {
        try
        {

            if (!Page.PageLikes.Any(pl => pl.AuthorId == UXUtility.LoggedInUser.Id))
            {
                Like like = new Like();
                like.AuthorId = UXUtility.LoggedInUser.Id;
                like.AuthorName = UXUtility.LoggedInUser.Name;
                like.LikedAt = DateTime.Now;
                like.IsLiked = true;
                like.AuthorEmail = UXUtility.LoggedInUser.Email;
                Page.PageLikes.Add(like);
            }
            else
            {
                Page.PageLikes.Where(pl => pl.AuthorId == UXUtility.LoggedInUser.Id).
                   Select(c => { c.IsLiked = true; c.LikedAt = DateTime.Now; return c; }).ToList();
            }

            HttpResponseMessage message = await ClientService.PutAsync(Page);
            if (message.IsSuccessStatusCode)
            {
                await BusinessPageRecentActivity(Page.Id, Page.Name, "You have recently liked Business Page" + Page.Name);

                ToastService.ShowSuccess("Page Like Successfuly");
                if (Page.Core.CreatorId != null && Page.Core.CreatorId != UXUtility.LoggedInUser.Id)
                {
                    Notification NotificationModel = new Notification();
                    NotificationModel.SenderId = UXUtility.LoggedInUser.Id;
                    NotificationModel.ReceiverId = Page.Core.CreatorId;
                    NotificationModel.SentAt = DateTime.UtcNow;
                    NotificationModel.NotificationType = "Business Page";
                    NotificationModel.Message = UXUtility.LoggedInUser.Name + " has liked your business page " + "'" + Page.Name + "'";
                    NotificationModel.Url = "businesspage/" + Page.Id + "/" + Page.Name ;
                    await NotificationClientService.PostAsync(NotificationModel);
                    if (IsNotiBPOLikeConnected) await SendBPageOLikeNotification();
                }
            }
        }
        catch (Exception ex)
        {
            SLog.Write(ex.Message);
        }
    }

    public async Task PageUnLike()
    {
        if (Page.PageLikes.Any(pl => pl.AuthorId == UXUtility.LoggedInUser.Id))
        {
            Page.PageLikes.Where(pl => pl.AuthorId == UXUtility.LoggedInUser.Id).
                Select(c => { c.IsLiked = false; c.LikedAt = DateTime.Now; return c; }).ToList();
            HttpResponseMessage message = await ClientService.PutAsync(Page);
            if (message.IsSuccessStatusCode)
            {
                ToastService.ShowSuccess("Page UnLike Successfuly");

            }

        }
    }

    public void GetSearchedString(string str)
    {

        SearchString = str;
        StateHasChanged();
    }

    protected bool IsVisible(JobPosting Job)
    {
        if (string.IsNullOrEmpty(SearchString))
        {
            return true;
        }

        if (Job.Name.ToUpper().StartsWith(SearchString) || Job.Name.ToLower().StartsWith(SearchString))
        {
            return true;
        }
        return false;
    }


    protected async void DeleteJobPostingAsync(bool Value)
    {
        if (Value)
        {
            try
            {
                Jobs = await Service.DeleteObject(Jobs, JobId);
                await BusinessPageRecentActivity(Page.Id, Page.Name, "You have recently deleted a job " + Jobs.Find(j => j.Id == JobId).Name + " from Business Page" + Page.Name);
                if (Jobs != null)
                {
                    StateHasChanged();
                    ToastService.ShowSuccess("Job Posting Deleted Successfuly");
                }
            }
            catch (Exception ex)
            {
                ToastService.ShowError(ex.Message, "Deletion Failed");
            }

        }
    }

    protected async Task BusinessPageRecentActivity(string Id, string Title, string description)
    {
        UserActivity userActivity = new UserActivity();
        userActivity.Core.CreatorId = UXUtility.LoggedInUser.Id;
        userActivity.Activities.Add(new ActivityModule { FeatureId = Id, Feature = Title, SubModuleId = "", Description = description });
        await Activity_ClientService.SubmitUserRecentActivityAsync(userActivity);
    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IVersionInfoService VersionService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IToastService ToastService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager navigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ILoginService loginService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IServiceProvider MyServiceProvider { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient http { get; set; }
    }
}
#pragma warning restore 1591
